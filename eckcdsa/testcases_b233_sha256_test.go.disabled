package eckcdsa

import (
	"testing"

	"github.com/RyuaNerin/go-krypto/internal"
)

func Test_Verify_B233_SHA256_Short(t *testing.T) {
	tc := testCases_B233_SHA224
	if testing.Short() {
		tc = tc[:1]
	}
	testVerify(t, tc, b233, hashSHA256)
}

var testCases_B233_SHA256 = []testCase{
	////////////////////////////////////////////////////////////////////////////////////////////////////
	// 암호알고리즘 검증기준 V3.0
	// 테스트 벡터
	// EC-KCDSA_(B-233)(SHA-256)_SGT.txt
	{
		M:  internal.HB(`8D3AC2E592FEC4A8D1EE1BAB436F1FC3446F99791DD4FE5EB599D024E5F0C727785D2F8F632A1DB54222EBED8EF69A5FAF3C87235E62242E628F00533EC6EDF2C2498E7C1D8E057B62C018411F2896E9FC6D34CEEE10BE25130CD5DDA901077239D891D9783D8027E8E58D28BBFB748009A2048ADBF6C69414726FA3BF1BEB6A`),
		Qx: internal.HI(`16FD484F8C90C15C9EB09930E1C55F92491C6A8E5CDAFDFB8A5CE3501D1`),
		Qy: internal.HI(`08BE4DBBA007B10978642BDC23EF9FAB0A9ABA62B4ECACDD76A49522AA2`),
		R:  internal.HI(`EF6B244601B1E37FF958B4E5640CD7409D625BC98DF14B8BBFBC6F395D148CF0`),
		S:  internal.HI(`4BFACB1C49632A1C0F7663133D6985885710415E5C452DF5455ECE5BF8`),
	},
	{
		M:  internal.HB(`CF6C519BD5527D30B1359EE8CB6C7B8CE000C431DB331E15D7A85550BF9553E6A3EF4E7E3FF0D353C4DD04906580DDBDB136A9614CEE918BF71E755891F8E43AF8D5720767433E955190E4F64346B10AD67950863156CF1E36CD27F5C4D52A013B170E83A67E6645AD8BC9BAC9D1F6B4CD8ABFCF3AA374407E362A2991C6991F`),
		Qx: internal.HI(`1C8326F1CFC1AE889B56AE9B5E3E9934BF13272A7264041E04FBEA5A5CF`),
		Qy: internal.HI(`0BEB1FE4F3384B869A612555D2E1EFC408D364888DFDA8D73BD9717E779`),
		R:  internal.HI(`D144B3C38177D0BFE9A3DF20EECE4CFB01AF339CB2FE5FF6F6FE5EEF84076139`),
		S:  internal.HI(`9D205D61BF946DF5DE09FE58FA9AB211DEB877BFBAA876AD37ECD025F7`),
	},
	{
		M:  internal.HB(`0137DB07FEDDD8F95793A4420340964241AD6235BC1401ACE360A5C1D56D8EC00640FA7019A20B8EF5F3D2BDA4B8608301B10F79B5F0E1649FDC274D1A714B582FC5F46248195C2A5781162209660C9106EC0225C98765B015C2A82B8E86FEA389DEBA4A8596123B72989B3033803ACA703DE1874730C823CEB2857B0A63BAA5`),
		Qx: internal.HI(`199FC957C1F1702DC6A4EBB758F024BD364891D29FACCCABF2963C6D61B`),
		Qy: internal.HI(`0D23D6177649FE84453BFE167DA264A9319AA8D0A47622D8EEC0749FCF7`),
		R:  internal.HI(`13284F38CA49CD75C5CE3C68C154F4D9FBFFA7BEA2F149FA3DE475DDD396122F`),
		S:  internal.HI(`B2A42B9A3893CA0EF0B0B09BD30C8A06FE051D3591458E6E6FFC32D5B1`),
	},
	{
		M:  internal.HB(`4730A55D71735A76661CF26ECF4273D7890AB9BA234A2B977ED686290CCB7BA9C6E4769956144BDA797A192931F226A7C141FE9FFD3D992D00DCDBE8BC8726438CAC57C125E4E3AD19A7727A54DDAC72AF588EDE1878044F54FE1A32EA68874F44C2D8627957077CDD1EC73FDB5944B8164FAEE7647245B0A7FB424B0E4651F0`),
		Qx: internal.HI(`1A974A6A69FE4C8E215591F07648D825111514EFBB6E7E9BD21388043B3`),
		Qy: internal.HI(`06D1F60B30AC78435BB35FCA7B12CC94F93B4B529029FF92EE641980299`),
		R:  internal.HI(`AC44CC58D4C947DA4F0DFA43EB256500831E149F26E772DE02D336B040299BD6`),
		S:  internal.HI(`D3B4F693AA1499B84B2D93A71B56624A7EB1C74BDC132F9B520EF32A44`),
	},
	{
		M:  internal.HB(`C4EAF2D291E8861C84E44C1E13C31740DDAB0BF474AB20484A1DBB3D46052094076E072D591A16ADF3859C88EE81351B167ABA0688A93D5ABA3253DB5C8C7AEC321EDF58627955933B15BBB1090095A1F75338E584FD2F70979542C0BDCEC9F69257AC00E597CA7D9032129AA7B21870E3546A23F63D715BAC24274E82C362F5`),
		Qx: internal.HI(`11E4ED0FBB3EF79B25F323B49B4147898F6A7719ACE5F95605F15B5132F`),
		Qy: internal.HI(`1FD7BD54B4097BBF9F531C9C4785ACE42F3DA98A847E32A52DE76909EB7`),
		R:  internal.HI(`E1CFC7B4AF9F6EB55B9D6B4E85A8662154A389A146C5D1C7896608FE85CC7B54`),
		S:  internal.HI(`35692C3EEE089D9E683F07D3A156E9A12373FA8916D10C63BFA5FC3BDB`),
	},
	{
		M:  internal.HB(`9CFA0699C311E15F53FE7509B31A867262249D1714096335ED4908B16A6E8175EC72EF608789F1790827208CC1B98FD524F086E3BA08516074F355DBDCD6494A46B1D05B62AB395060E1B57C0C1FCA12016F437070E96C86829BE587EA0EC88F97307A562E2ADEB130E73FF579DFB9E8FBE0586E6164CE988442F638492EF1A8`),
		Qx: internal.HI(`0C99207791629C16DA3C46FD0872E732C2E7BEC438EB60E905AA4130C10`),
		Qy: internal.HI(`1018ACC0085BD5C3B680FBF98078F49C9B87B7D68551D786121A644236F`),
		R:  internal.HI(`8391DBFA2E64F7F5BE5AB1AFF272D55E3DECF3D87C6D4BAB873DDAA814E90533`),
		S:  internal.HI(`0353E42ECE1B885523CFFE8106AEF480E542E65C17CB1165B3C3814C5E`),
	},
	{
		M:  internal.HB(`F4F426E56BC1EEB3787F32E09298C35F3A09B35665387AD10A6E31395959A0419985746744345FB35C7568EB8CEF38C70F37A869F82D59B2D132A49C23B7994FEBF66FFE8A4E10582D1D258D419150B9F142F4B140113E05BA25C53D557A890C76E28799B7E2C78E6153130536332C128288BDFD0ABCE2DCD06775BD47DB02FC`),
		Qx: internal.HI(`05EF20E7914E08FAE8BBF21791530368E500EA107913D1C1E566FC15806`),
		Qy: internal.HI(`100DBB228ED0D723A9B0AB3EA678E0A1E853AF3960A95AA402E9F8399AA`),
		R:  internal.HI(`6053A479334992C05D9FED5C337FE6EBA887242895D58A9C98E1EDD2BE51B76E`),
		S:  internal.HI(`48FAEBC92C2735524486C6D5DC81648299973E56E1EB6C79F86CF1D89D`),
	},
	{
		M:  internal.HB(`EF6B95ECECCC318C967B46599593D3FD8BEE90E6CC0EE79046A1FA89F91C83EC333BDA74F3EFE5CF93833959347635E7FBE462CEA4EDD9C4750303D212856DEF468400763E36611E46DECF9B8CAA2B89EB5F8FDC58492861E246A894E2680E61540116FEE5940A86C788527DC20374E49CDEDD0353192F9936A96791611E9AE6`),
		Qx: internal.HI(`0B0188D092DE176B1DECD8176C519DBA7A394BB3C6054A6580B6CBBF964`),
		Qy: internal.HI(`0F884179151CEC1BDD20706AC4DAAFD855BA96E37BE5D179AA056E4B47B`),
		R:  internal.HI(`7FFC64127C79E38FB55AED4DA68309ECD3728ABAFF1DBCFBB6D6163F2E06067B`),
		S:  internal.HI(`BDAB56D5742AACD1F32E5B3C407880197101D972180D95EEBE3D22B66D`),
	},
	{
		M:  internal.HB(`B2F497E1AB062F5D52067628A15FB93E776779FAAE5D30E743F627552D092C69DD2763BDF98E0641506556899CA38A280C89F843241B550A057B38318F92C91F7AEDC4F5E137AD174F387657D0BD5E78135A58271C64AF0F9E125041762A5D8354206BB81C152A0E059BBF1200A197506D77FCB5A24E3A46581C8F687A4BBC59`),
		Qx: internal.HI(`0BA70A1F3C0837EC9E44DB1666EEFBE708D0E874D0C9B5BFD5117D394AB`),
		Qy: internal.HI(`1B1AF81C69CEC921FB22A9B3FDE3C84674212905A4E3A87835A26731A0F`),
		R:  internal.HI(`FAA66D398BB92BF70C5EC15A48E09DCCF9409E008B69E9741DE847811AF2A8CB`),
		S:  internal.HI(`3D59B29DCAF2DFCDB794EEA1315571D4F22BDC1751C1DC67F296A3F80E`),
	},
	{
		M:  internal.HB(`612270F80B436B9B50348600984E7B172309B2C76DF9D748A77F7C50DA75A1ADBCDE5575B9E5467C382E842FAAC93B7D65BCB000DB8C50F924AD066D7D33B2D2ABC503B1D7267AB7EB3EDE77F31EEF798DC792C3F0375882929E83F8F41579659BD3CAFABF38AC9AC0A01F77D664974C19E85E475A308754DCD2B3F676B66B49`),
		Qx: internal.HI(`0FBA01BE57E5A26BC6A4F7F9ACC4DDC6823BDBA5D85606BA0C2158F711B`),
		Qy: internal.HI(`186F3D7F294DFAD59F76AD1C386FC4FB11CE084DBFB7BD2CE735CFB8792`),
		R:  internal.HI(`8BC6533CB00D45CF05FF1AD0E68F06BE4BCBF5F85BC3372EA3B91491F5E1B213`),
		S:  internal.HI(`B733D5A78CC1073107E8ABE0234624FF696730174DC9B06B63DD9DAEDE`),
	},
	////////////////////////////////////////////////////////////////////////////////////////////////////
	// 암호알고리즘 검증기준 V3.0
	// 테스트 벡터
	// EC-KCDSA_(B-233)(SHA-256)_SVT.txt
	{
		M:  internal.HB(`D52CA72AE700D9340B73F3530C6519593C00EB96A4CE5CF0CA00098402233845A90C28AA3050DBF96DFDFB2B07EC10F67669A008708268FA3CBB58FDBF7B78D0BEED590431A744190EDDC5748763C2C2FE4BBFC4C6667E15ED709DEB132A5F66B2364161AFF18E68AF138CC113707A1EF781F406301BFB699F143675CB0A9C3A`),
		Qx: internal.HI(`1848A4715C7319CD7C0DE81159974CBBDFE01A47224357BD445EF7E0B5C`),
		Qy: internal.HI(`190DAF6B2A97184ADE2AF85F272ECF5201DCADE4EFF092539C50542A3A3`),
		R:  internal.HI(`6BF9BB8AFAED160FBC0B1490B321C0EDEF9C6E4FFEF5B85F750880A64EAEDEE4`),
		S:  internal.HI(`052005A6357E0BD44674C04F29C61EB571A59F883D5624B701581E302F`),
	},
	{
		M:  internal.HB(`393012F983F865168CD1CBBB244A1189CF3334C0AB05C81E85C9E83B5FA527D22DBE8EE51B8D3512185E7519F50D4BE5E1B7D8108588AB3D8A45BD3FD3BBB36133CA78D2DE1CA57B7145CB4CC16622464B05A843833A36D8D0DE903B7AE30794517D96A6583F2B313AE0FEFDD1C198EC8AE98103E7962FD3EF122A1DCFECF730`),
		Qx: internal.HI(`1F46F149D1193467A5CD0157D00B37F0ACDC61309A8D9BC87AE1F1AE846`),
		Qy: internal.HI(`1B1B4729D0D717521A2575E5F41ADD055B8741560A569ECBDC1FEC2E58F`),
		R:  internal.HI(`4C75A954F3E0D2BEDC07091B764BF61973D37D0F1D2958F496FE70527EE8EACD`),
		S:  internal.HI(`81FABDBEC6CAC44038E0557136CB9ED3FD2F6C14B636CF2E2789536B54`),
	},
	{
		M:  internal.HB(`46DACF7F56E51AFDD06A5CD44F52210275678359E20B1762A87858B56E000283DD5D44B08A98272B009022DF0CA236FE07867CEA2BE19992AD91E876C744E02E425E82B0CCB24D20A01B8E73BA7E84B241343214447454CB77B352C71D90A623BD4791ACD5498D1C2BDF6977E4866D3B10EC6EB7CC2D4B45A446A3C160563BF2`),
		Qx: internal.HI(`003FD5ED3154C2DE33BC4A3BC57BDC884985FFC95508306340AC80C6746`),
		Qy: internal.HI(`14F84C4497A8536EB3420A8DB152750EE077FD97B5425E7329B1A962913`),
		R:  internal.HI(`E56356951E10590F5ABA6824B5AF660ED3E962B2CAE7BEACC9158F42A3D147DA`),
		S:  internal.HI(`1093B4CA4614CFD32899D8D6F90D4E7D05C4B0D5D9D514269A76C32FE8`),
	},
	{
		M:  internal.HB(`A8FE382519EE4A63D40439DD01599DA854821C271E891C1AD76DE846B28C127A3AE05306887FBC511F3670C0DFBBC4833749F582002357061ECF284E698EE4B5DCD66188A5576C4809613C70B80C83678B265BD13432E5DEF86CD2C0E43DB0F498042F8324973CE1056B2497CCCC975E6C02CFD1C5DB9A606D70A3A939A1A5E9`),
		Qx: internal.HI(`1B6AC640EA59DD8B0C8020136872C03FE48FD22EF6657F64EA19FF43B0D`),
		Qy: internal.HI(`162D740D7B0797A7CE999A652E573D5FED35E6DD2ABB65EF279CAF3644C`),
		R:  internal.HI(`DA41905D2AE87E37ABC3F294310B31A33CAB047320946A349120DABB9893C283`),
		S:  internal.HI(`B14F29BC68A0BFF7753739347EDB309350582DCBC25B7314E5535986F4`),
	},
	{
		M:    internal.HB(`1BF29A6364F7FEAEC616A80185A4BD1E50390864493692AA90BDE122C5DD8A484F483468EF4DC9C66A6BDFE7C937200E0BEBC26AAE5EC20708AB0704BF571715603583E06FDAB338D7E03DB731C26AD1B49E14DA48A185029C6181E9ADFB18AD94267F2122207716169D8E4E5EA2C7245673DA5C5773BA4299397D85B3995EE2`),
		Qx:   internal.HI(`12EEEAE0CF2F2FF82CC1DF8A0C5CCC58F66B9269188F2267E4A66E31529`),
		Qy:   internal.HI(`1CD2C63FDF18628C43102B5484F07C2F97B798393193E04F6F8605AC5F6`),
		R:    internal.HI(`D21A668282613E48D7E41594B2389D0D4F07E607B5DCE8FC42C71C9E8E45DDAC`),
		S:    internal.HI(`D615CA9BFBC9376B52BFB9388F0CEC69C016F0B9149BCEC445541A52B8`),
		Fail: true,
	},
	{
		M:    internal.HB(`7844CD89801D3FE94DC585090863DBAC8E6F1B009C673C4C5B32CC913ACE8BF33779886683F7ED7FAF29E6D1348BC0BCA5CEB61D403581BF3BD92FFC8678476A5508C3132D9FE901C9EC8DA69BD8BDEC268B66680F66F8921A2A9264DDF4B357802B120E3F0F86B70417996BD6B7CD8871C41565C01689509495E8304E53E0C6`),
		Qx:   internal.HI(`1673C585D9FB76621C4A5661EC48A2C5B80F5EA99B153C461F2479DDE0E`),
		Qy:   internal.HI(`1351E730023855492306C7079BD350B37F5CCC2E0568B64459F9BBD7F92`),
		R:    internal.HI(`A25AB83B765ECE8E043D1F1BAD1B8C28D352C7D132C27A7F2D12973A5E1CCABB`),
		S:    internal.HI(`FA78189D67370A860AD5F5B473B98BA98DE7780C9B75F4C8108B0F70E4`),
		Fail: true,
	},
	{
		M:    internal.HB(`F54428B9CD3D659946FE4D4C08BE3679B651DAB3C74C2BB0011E07B94B46CF9DF8182CEC2B2402CA8BBEEC17E8BC2F39EFE48458A81DAE44DCE537DC05154130FC79DA36054FAD4E6621835C2D167BCB4C385638BAB5D311B9AA6EEAF0797AD8793CF09A954FEECB208435F78208A4CF2B78134A593B65F1459E54335CC2C9EC`),
		Qx:   internal.HI(`0267FED4DF25C62AA9ADA535D6B2B04CCF4D27668EA5B2FF00FAFF67B76`),
		Qy:   internal.HI(`06138C52862690DC46353BAD5552648A32231031887DDFB64950235CF79`),
		R:    internal.HI(`547C5E9E2E43287FACDE862CF4908411D70D85C421EAC1F6D690CE1E4F7A61BD`),
		S:    internal.HI(`6CEFA9BC88E52603FEEA6DB492BB5A0CD874AE7805EFB210D4C3EE8509`),
		Fail: true,
	},
	{
		M:  internal.HB(`E7E2C2AEC7DA18CA8DF1914AE68E197E267A9B52FBCDDAED36C77BA098849A5139E1A9038D91DFA590BBFED72204C5C41484C5BAFC74E8B1470F785E9F83E6FE246318838A79904C92682608FD00ACF571B03A20590066CD516A41AC1F9D500BBE6A51A8905A1249315924C7F64BAFAEA6023124787A7030C8BD6619A8606DF9`),
		Qx: internal.HI(`0A11B47436DDD0E8729B1A01F6A4C254083FD0B34DEA2E0272609248FBC`),
		Qy: internal.HI(`0AD7875D836071182A18DCCD79655F2200AF3959FDABE64E626DD4FA57B`),
		R:  internal.HI(`6996E514058EB2FC5D5E7458F1ADBF2EBB9977E56C44D45E18F62A98839C47D0`),
		S:  internal.HI(`750035CBD5D4225928DEF4EF894711B5A01AA7D4B1BD867A7AC424707D`),
	},
	{
		M:  internal.HB(`FB7E339C84B5EFB6F9FD48AF3A1654C586C8AAE8798A90C7F55E7DF5E13B129A26B12FCED0305911B89D08F6A59314874F06E05F1A9D6C12088BF9E4BF1D664F03E4EE719EA169D70FD8C9C0F03EE24E78D73DBC00FE0B15F433F47F21E2CE9AB1F908F9D690CB4A8069992905997C2324127E0556677DE2BD871DF7B5BEEBD6`),
		Qx: internal.HI(`0EC38C9DFCA9343DC71B791826C5AA21858B8E2D9CB370AF1F7245CD8D0`),
		Qy: internal.HI(`05879ED6229014B080255991D9FFF52F4FC3CCC6BDD3D0AD21DBAB84A3C`),
		R:  internal.HI(`708591F23647D62A986604D000A2773053B050DCFF4C720B42BB09F06E801285`),
		S:  internal.HI(`600FCE47EC70614903DE116B35F6951BA09DA535E48D2DD14661BFC6AF`),
	},
	{
		M:    internal.HB(`BA6000E9EBF15195F6CA75558D66B87F76A869D3FB9636719F6DA3B04E260A24DA2146CF0B167BDE0AF811DB6BED67BCA80A3EB145F874257B2305D297AEE450F1BABA07AD3D00F41808921BEC263117363A04B63907A8F703C8C461077FB81A84E86B9CF931C07A7E25B51C30EEBFD29715602E32F4850B082AB22B735785C9`),
		Qx:   internal.HI(`1C596AE0A34D5658D6C998E17FCE0180FBCAC637E5CFACAF2963054CA2E`),
		Qy:   internal.HI(`0B4426FE0DB9C16E408A784242F7C20CAF517B7F701BF02B7D1550F5D58`),
		R:    internal.HI(`843DBC5FEB99BCC3A991549891077676414D9A38061587CDBE315CE741D35198`),
		S:    internal.HI(`118D22DE55BCB1A39E3BF6C6E232B8EC1E30FBB030F6FCAB0B83C82927`),
		Fail: true,
	},
	{
		M:  internal.HB(`840431335C6BD89C288A2AF70F2A896269B6DB329D3EA5465285F5D914AC969E2371596F7FA0F45AECAB554A0BFCCE203A03067D508D1905F466CE64AED83FE24BFEF7C7DA8CC953CFF66CA880962B4BA7D699AB06CFB650E38A651D754BA152F40052A1795037243E66B8728AE2239ACE13215531F6E0382F00CA1B6B434296`),
		Qx: internal.HI(`1A4EE568F7AEBECFD5B59BE99D9B96A04D6ACAA2EA58D6F733ECCC7C79F`),
		Qy: internal.HI(`1CCE6DAEE72EEEEE4DC7A2D3F69524A6B5713BF7BE5FD8A9CBF372831CC`),
		R:  internal.HI(`680729270584A09C266BD44606503634799DDD67C63CEE935F52C569658C4843`),
		S:  internal.HI(`E2017F8A712E54AA21D3DBB823BEF100E1FEE41E657957C719E967EE5D`),
	},
}
